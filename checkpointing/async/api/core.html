

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Asynchronous Checkpoint Core Utilities &mdash; nvidia-resiliency-ext 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Asynchronous FileSystemWriter Implementation" href="filesystem_async.html" />
    <link rel="prev" title="API documentation" href="../api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            nvidia-resiliency-ext
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../fault_tolerance/index.html">Fault Tolerance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../inprocess/index.html">Inprocess Restart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Async Checkpointing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../usage_guide.html">Usage guide</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">API documentation</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Asynchronous Checkpoint Core Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller"><code class="docutils literal notranslate"><span class="pre">AsyncCaller</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue"><code class="docutils literal notranslate"><span class="pre">AsyncCallsQueue</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest"><code class="docutils literal notranslate"><span class="pre">AsyncRequest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller"><code class="docutils literal notranslate"><span class="pre">PersistentAsyncCaller</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller"><code class="docutils literal notranslate"><span class="pre">TemporalAsyncCaller</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="filesystem_async.html">Asynchronous FileSystemWriter Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="state_dict_saver.html">Asynchronous Pytorch Distributed Checkpoint save with optimized <cite>FileSystemWriter</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="torch_ckpt.html">Asynchronous PyTorch <cite>torch.save</cite> with the Core utility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../local/index.html">Local Checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../straggler_det/index.html">Straggler Detection</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nvidia-resiliency-ext</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Async Checkpointing</a></li>
          <li class="breadcrumb-item"><a href="../api.html">API documentation</a></li>
      <li class="breadcrumb-item active">Asynchronous Checkpoint Core Utilities</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/checkpointing/async/api/core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-nvidia_resiliency_ext.checkpointing.async_ckpt.core">
<span id="asynchronous-checkpoint-core-utilities"></span><h1>Asynchronous Checkpoint Core Utilities<a class="headerlink" href="#module-nvidia_resiliency_ext.checkpointing.async_ckpt.core" title="Link to this heading"></a></h1>
<p>This module provides an async utilities which allow to start
a checkpoint save process in the background.</p>
<dl class="py class">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nvidia_resiliency_ext.checkpointing.async_ckpt.core.</span></span><span class="sig-name descname"><span class="pre">AsyncCaller</span></span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCaller"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Wrapper around mp.Process that ensures correct semantic of distributed finalization.</p>
<p>Starts process asynchronously and allows checking if all processes on all ranks are done.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.close">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCaller.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.close" title="Link to this definition"></a></dt>
<dd><p>Terminate the async caller at exit of an application or some termination conditions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.is_current_async_call_done">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_current_async_call_done</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocking</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCaller.is_current_async_call_done"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.is_current_async_call_done" title="Link to this definition"></a></dt>
<dd><p>Check if async save is finished on all ranks.</p>
<p>For semantic correctness, requires rank synchronization in each check.
This method must be called on all ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, will wait until the call is done
on all ranks. Otherwise, returns immediately if at least one rank
is still active. Defaults to False.</p></li>
<li><p><strong>no_dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>Optional</em>) – if True, training ranks simply check its
asynchronous checkpoint writer without synchronization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if all ranks are done (immediately of after active wait</dt><dd><p>if <cite>blocking</cite> is True), False if at least one rank is still active.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.schedule_async_call">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">schedule_async_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">async_req</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCaller.schedule_async_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.schedule_async_call" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Schedule <cite>async_req</cite> with some process forking or reusing</dt><dd><p>persistent worker</p>
</dd>
</dl>
<p>This method must be called on all ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>async_req</strong> (<a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest" title="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest"><em>AsyncRequest</em></a>) – <cite>AsyncRequest</cite> object containing to
start async process</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.sync_all_async_calls">
<span class="sig-name descname"><span class="pre">sync_all_async_calls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_alive</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCaller.sync_all_async_calls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller.sync_all_async_calls" title="Link to this definition"></a></dt>
<dd><p>Check if all ranks have completed async checkpoint writing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_alive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if True, the current async request is not completed</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if all ranks are done, False if at least one rank is still active.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nvidia_resiliency_ext.checkpointing.async_ckpt.core.</span></span><span class="sig-name descname"><span class="pre">AsyncCallsQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">persistent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCallsQueue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Manages a queue of async calls.</p>
<p>Allows adding a new async call with <cite>schedule_async_request</cite> and finalizing
active calls with <cite>maybe_finalize_async_calls</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>persistent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCallsQueue.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.close" title="Link to this definition"></a></dt>
<dd><p>Finalize all calls upon closing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.get_num_unfinalized_calls">
<span class="sig-name descname"><span class="pre">get_num_unfinalized_calls</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCallsQueue.get_num_unfinalized_calls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.get_num_unfinalized_calls" title="Link to this definition"></a></dt>
<dd><p>Get the number of active async calls.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.maybe_finalize_async_calls">
<span class="sig-name descname"><span class="pre">maybe_finalize_async_calls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCallsQueue.maybe_finalize_async_calls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.maybe_finalize_async_calls" title="Link to this definition"></a></dt>
<dd><p>Finalizes all available calls.</p>
<p>This method must be called on all ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, will wait until all active requests
are done. Otherwise, finalizes only the async request that already
finished. Defaults to False.</p></li>
<li><p><strong>no_dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, training ranks simply check its
asynchronous checkpoint writer without synchronization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>list of indices (as returned by <cite>schedule_async_request</cite>)</dt><dd><p>of async calls that have been successfully finalized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.schedule_async_request">
<span class="sig-name descname"><span class="pre">schedule_async_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">async_request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncCallsQueue.schedule_async_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCallsQueue.schedule_async_request" title="Link to this definition"></a></dt>
<dd><p>Start a new async call and add it to a queue of active async calls.</p>
<p>This method must be called on all ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>async_request</strong> (<a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest" title="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest"><em>AsyncRequest</em></a>) – async request to start.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>index of the async call that was started.</dt><dd><p>This can help the user keep track of the async calls.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nvidia_resiliency_ext.checkpointing.async_ckpt.core.</span></span><span class="sig-name descname"><span class="pre">AsyncRequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">async_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">async_fn_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finalize_fns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">async_fn_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preload_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncRequest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>Represents an async request that needs to be scheduled for execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>async_fn</strong> (<em>Callable</em><em>, </em><em>optional</em>) – async function to call. None represents noop.</p></li>
<li><p><strong>async_fn_args</strong> (<em>Tuple</em>) – args to pass to <cite>async_fn</cite>.</p></li>
<li><p><strong>finalize_fns</strong> (<em>List</em><em>[</em><em>Callable</em><em>]</em>) – list of functions to call to finalize the request.
These functions will be called synchronously after <cite>async_fn</cite> is done
<em>on all ranks</em>.</p></li>
<li><p><strong>async_fn_kwargs</strong> (<em>Tuple</em>) – kwargs to pass to <cite>async_fn</cite>.</p></li>
<li><p><strong>preload_fn</strong> (<em>Callable</em>) – preload function to stage tensors from GPU to Host.
This should be self-contained with a proper list of arguments with  <cite>partial</cite>.</p></li>
<li><p><strong>is_frozen</strong> (<em>Bool</em>) – a flag to indicate this async request can be modified or not.</p></li>
<li><p><strong>call_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – index variable used to order async requests for synchronization
in preloading and writing tensors on the async caller</p></li>
</ul>
</dd>
</dl>
<p>Create new instance of AsyncRequest(async_fn, async_fn_args, finalize_fns, async_fn_kwargs, preload_fn, is_frozen, call_idx)</p>
<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.add_finalize_fn">
<span class="sig-name descname"><span class="pre">add_finalize_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncRequest.add_finalize_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.add_finalize_fn" title="Link to this definition"></a></dt>
<dd><p>Adds a new finalize function to the request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – function to add to the async request. This function
will be called <em>after</em> existing finalization functions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.async_fn">
<span class="sig-name descname"><span class="pre">async_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.async_fn" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.async_fn_args">
<span class="sig-name descname"><span class="pre">async_fn_args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a></em><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.async_fn_args" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.async_fn_kwargs">
<span class="sig-name descname"><span class="pre">async_fn_kwargs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a></em><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.async_fn_kwargs" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.call_idx">
<span class="sig-name descname"><span class="pre">call_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.call_idx" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.execute_finalize_fns">
<span class="sig-name descname"><span class="pre">execute_finalize_fns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validate_matching_call_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncRequest.execute_finalize_fns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.execute_finalize_fns" title="Link to this definition"></a></dt>
<dd><p>Execute all the finalize functions associated with this async request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>validate_matching_call_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Validate that all ranks
invoke CP finalize on the same call_idx. This is typically useful in
async CP stages where multiple CP requests can be pending.
This validation is unnecessary during synchronous CP step.
When this param is True, an AllReduce Sync across all participating
ranks is invoked. Default set to True for conservative validation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The call_idx of async request that has been finalized</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>call_idx</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.execute_sync">
<span class="sig-name descname"><span class="pre">execute_sync</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncRequest.execute_sync"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.execute_sync" title="Link to this definition"></a></dt>
<dd><p>Helper to synchronously execute the request.</p>
<p>This logic is equivalent to what should happen in case of the async call.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.finalize_fns">
<span class="sig-name descname"><span class="pre">finalize_fns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.finalize_fns" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.freeze">
<span class="sig-name descname"><span class="pre">freeze</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#AsyncRequest.freeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.freeze" title="Link to this definition"></a></dt>
<dd><p>Freezes the async request, disallowing adding new finalization functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>new async request with all same fields except for the</dt><dd><p><cite>is_frozen</cite> flag.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest" title="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest">AsyncRequest</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.is_frozen">
<span class="sig-name descname"><span class="pre">is_frozen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.is_frozen" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.preload_fn">
<span class="sig-name descname"><span class="pre">preload_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a></em><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest.preload_fn" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nvidia_resiliency_ext.checkpointing.async_ckpt.core.</span></span><span class="sig-name descname"><span class="pre">PersistentAsyncCaller</span></span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#PersistentAsyncCaller"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller" title="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncCaller</span></code></a></p>
<p>Wrapper around mp.Process that ensures correct semantic of distributed finalization.</p>
<p>Starts process asynchronously and allows checking if all processes on all ranks are done.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.async_loop">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">async_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preload_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#PersistentAsyncCaller.async_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.async_loop" title="Link to this definition"></a></dt>
<dd><p>Main function for the persistent checkpoint worker</p>
<p>The persisent worker is created once and terminated at exit or
when application calls <cite>close()</cite> explictily</p>
<p>This routine receives <cite>AsyncRequest</cite> and does <cite>preload_fn</cite> first and
put the integer value in <cite>preload_q</cite> to inform the trainer to proceed.
When the <cite>async_fn</cite> from the request` is completed (background saving is done),
it puts a integer value to <cite>comp_q</cite> to notify the trainer the completion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the rank of the trainer where the persistent worker is created.</p></li>
<li><p><strong>queue</strong> (<em>mp.JoinableQueue</em>) – the main queue used to receive <cite>AsyncRequest</cite>
from the training rank</p></li>
<li><p><strong>preload_q</strong> (<em>mp.JoinableQueue</em>) – a queue to inform trainer that preloading of tensors
from GPU to Host or dedicated location is completed</p></li>
<li><p><strong>comp_q</strong> (<em>mp.Queue</em>) – a queue to inform the training rank the completion of scheduled
async checkpoint request</p></li>
<li><p><strong>log_level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>Optional</em>) – an integer to set log-level in this spawned process
to get aligned with the training rank’s logging level</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#PersistentAsyncCaller.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.close" title="Link to this definition"></a></dt>
<dd><p>Wait on the left async requests and terminate the PersistentAsyncCaller</p>
<p>Signals the PersistentAsyncCaller by sending a ‘DONE’ message to make it terminated</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.is_current_async_call_done">
<span class="sig-name descname"><span class="pre">is_current_async_call_done</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#PersistentAsyncCaller.is_current_async_call_done"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.is_current_async_call_done" title="Link to this definition"></a></dt>
<dd><p>Check if async save is finished on all ranks.</p>
<p>For semantic correctness, requires rank synchronization in each check.
This method must be called on all ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, will wait until the call is done
on all ranks. Otherwise, returns immediately if at least one rank
is still active. Defaults to False.</p></li>
<li><p><strong>no_dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>Optional</em>) – if True, training ranks simply check its
asynchronous checkpoint writer without synchronization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if all ranks are done (immediately of after active wait</dt><dd><p>if <cite>blocking</cite> is True), False if at least one rank is still active.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.schedule_async_call">
<span class="sig-name descname"><span class="pre">schedule_async_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">async_req</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#PersistentAsyncCaller.schedule_async_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.PersistentAsyncCaller.schedule_async_call" title="Link to this definition"></a></dt>
<dd><p>Put <cite>AsyncRequest</cite> to the Persistent Async Caller</p>
<p>This method must be called on all ranks. The async_req object is pickled and
sent to the persistent async worker via a JoinableQueue.
Therefore, all arguments within async_req must be picklable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>async_fn</strong> (<em>Callable</em><em>, </em><em>optional</em>) – async function to call. If None,
no process will be started.</p></li>
<li><p><strong>async_req</strong> (<a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest" title="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest"><em>AsyncRequest</em></a>) – <cite>AsyncRequest</cite> object containing to
schedule a checkpointing request</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nvidia_resiliency_ext.checkpointing.async_ckpt.core.</span></span><span class="sig-name descname"><span class="pre">TemporalAsyncCaller</span></span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#TemporalAsyncCaller"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller" title="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncCaller"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncCaller</span></code></a></p>
<p>Wrapper around mp.Process that ensures correct semantic of distributed finalization.</p>
<p>Starts process asynchronously and allows checking if all processes on all ranks are done.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#TemporalAsyncCaller.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller.close" title="Link to this definition"></a></dt>
<dd><p>For TemporalAsyncCaller, this method is called explictly in <cite>is_current_async_calls_done</cite></p>
<p>This method make sure the TemporalAsyncCaller terminated
with all its assigned async request completed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller.is_current_async_call_done">
<span class="sig-name descname"><span class="pre">is_current_async_call_done</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#TemporalAsyncCaller.is_current_async_call_done"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller.is_current_async_call_done" title="Link to this definition"></a></dt>
<dd><p>Check if async save is finished on all ranks.</p>
<p>For semantic correctness, requires rank synchronization in each check.
This method must be called on all ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, will wait until the call is done
on all ranks. Otherwise, returns immediately if at least one rank
is still active. Defaults to False.</p></li>
<li><p><strong>no_dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>Optional</em>) – if True, training ranks simply check its
asynchronous checkpoint writer without synchronization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if all ranks are done (immediately of after active wait</dt><dd><p>if <cite>blocking</cite> is True), False if at least one rank is still active.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller.schedule_async_call">
<span class="sig-name descname"><span class="pre">schedule_async_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">async_req</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/async_ckpt/core.html#TemporalAsyncCaller.schedule_async_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.TemporalAsyncCaller.schedule_async_call" title="Link to this definition"></a></dt>
<dd><p>Spawn a process with <cite>async_fn</cite> as the target.</p>
<p>This method must be called on all ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>async_fn</strong> (<em>Callable</em><em>, </em><em>optional</em>) – async function to call. If None,
no process will be started.</p></li>
<li><p><strong>async_req</strong> (<a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest" title="nvidia_resiliency_ext.checkpointing.async_ckpt.core.AsyncRequest"><em>AsyncRequest</em></a>) – <cite>AsyncRequest</cite> object containing to
start async process</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api.html" class="btn btn-neutral float-left" title="API documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="filesystem_async.html" class="btn btn-neutral float-right" title="Asynchronous FileSystemWriter Implementation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, NVIDIA Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>