

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BasicTensorAwareStateDict &mdash; nvidia-resiliency-ext 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Examples" href="../examples.html" />
    <link rel="prev" title="BaseTensorAwareStateDict" href="base_state_dict.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            nvidia-resiliency-ext
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../fault_tolerance/index.html">Fault Tolerance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../inprocess/index.html">Inprocess Restart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../async/index.html">Async Checkpointing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Local Checkpointing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../usage_guide.html">Usage guide</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">API documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="callback.html">PTL Callback support</a></li>
<li class="toctree-l3"><a class="reference internal" href="base_ckpt_manager.html">BaseCheckpointManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="local_ckpt_manager.html">LocalCheckpointManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="replication.html">Replication</a></li>
<li class="toctree-l3"><a class="reference internal" href="base_state_dict.html">BaseTensorAwareStateDict</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">BasicTensorAwareStateDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict"><code class="docutils literal notranslate"><span class="pre">BasicTensorAwareStateDict</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../straggler_det/index.html">Straggler Detection</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nvidia-resiliency-ext</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Local Checkpointing</a></li>
          <li class="breadcrumb-item"><a href="../api.html">API documentation</a></li>
      <li class="breadcrumb-item active">BasicTensorAwareStateDict</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/checkpointing/local/api/basic_state_dict.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-nvidia_resiliency_ext.checkpointing.local.basic_state_dict">
<span id="basictensorawarestatedict"></span><h1>BasicTensorAwareStateDict<a class="headerlink" href="#module-nvidia_resiliency_ext.checkpointing.local.basic_state_dict" title="Link to this heading"></a></h1>
<p>BasicTensorAwareStateDict provides a simple implementation of the TensorAwareStateDict interface,
which is used to manage state dictionaries within a CheckpointManager.</p>
<p>This class requires that all tensors in the user-provided state_dict are located on CUDA devices
and are easily accessible (i.e., they can only be nested within dictionaries or lists).</p>
<p>This implementation covers the most common use cases
for state dict management in distributed training scenarios.</p>
<dl class="py class">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nvidia_resiliency_ext.checkpointing.local.basic_state_dict.</span></span><span class="sig-name descname"><span class="pre">BasicTensorAwareStateDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/local/basic_state_dict.html#BasicTensorAwareStateDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="base_state_dict.html#nvidia_resiliency_ext.checkpointing.local.base_state_dict.TensorAwareStateDict" title="nvidia_resiliency_ext.checkpointing.local.base_state_dict.TensorAwareStateDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorAwareStateDict</span></code></a></p>
<p>The most basic implemention of TensorAwareStateDict
defining the interface between the user code and checkpoint manager.</p>
<p>This class requires that all tensors in the user state_dict are
on cuda and are easily accessible (can be only nested in dicts or lists)</p>
<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.copy_tensors_to_cpu">
<span class="sig-name descname"><span class="pre">copy_tensors_to_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">non_blocking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/local/basic_state_dict.html#BasicTensorAwareStateDict.copy_tensors_to_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.copy_tensors_to_cpu" title="Link to this definition"></a></dt>
<dd><p>Stores CPU copies of tensors in the state_dict, replacing the originals,
but without destroying them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>non_blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if set to True allows for asynchronous copying.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.init_tensors">
<span class="sig-name descname"><span class="pre">init_tensors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/local/basic_state_dict.html#BasicTensorAwareStateDict.init_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.init_tensors" title="Link to this definition"></a></dt>
<dd><p>Initializes empty tensors with the same properties as the original tensors.</p>
<p>This function should only be called after the original tensors have been popped.
It ensures that the newly created empty tensors match the shape,
dtype, and device of the originals, but contain no data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.insert_tensors">
<span class="sig-name descname"><span class="pre">insert_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/local/basic_state_dict.html#BasicTensorAwareStateDict.insert_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.insert_tensors" title="Link to this definition"></a></dt>
<dd><p>Reverse of <cite>pop_tensors</cite>. Replace tensor placeholders with actual values.
The value of <cite>self</cite> is considered to be the same after:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">insert_tensors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pop_tensors</span><span class="p">())</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor_data</strong> – An iterable containing the tensor data to be inserted</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.is_hollow">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_hollow</span></span><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.is_hollow" title="Link to this definition"></a></dt>
<dd><p>True iff tensors had been extracted and have not been inserted back yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.pop_tensors">
<span class="sig-name descname"><span class="pre">pop_tensors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/local/basic_state_dict.html#BasicTensorAwareStateDict.pop_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.pop_tensors" title="Link to this definition"></a></dt>
<dd><p>Extracts the tensor data from the state dict, preserving metadata.</p>
<p>Removes the tensor data while retaining metadata (e.g., shape, dtype, device)
needed to recreate empty tensors. After this operation, the state dictionary is “hollow”,
containing no tensor data.
Further calls to <cite>pop_tensor</cite> will raise an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of extracted tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.restore_tensor_device">
<span class="sig-name descname"><span class="pre">restore_tensor_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">non_blocking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/nvidia_resiliency_ext/checkpointing/local/basic_state_dict.html#BasicTensorAwareStateDict.restore_tensor_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.restore_tensor_device" title="Link to this definition"></a></dt>
<dd><p>Restores all tensors to their original CUDA devices if a move is required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>non_blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if set to True allows for asynchronous copying.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.tensors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tensors</span></span><a class="headerlink" href="#nvidia_resiliency_ext.checkpointing.local.basic_state_dict.BasicTensorAwareStateDict.tensors" title="Link to this definition"></a></dt>
<dd><p>Get the tensor data from the state dict.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="base_state_dict.html" class="btn btn-neutral float-left" title="BaseTensorAwareStateDict" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, NVIDIA Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>